(this["webpackJsonpexchange-app"]=this["webpackJsonpexchange-app"]||[]).push([[0],{110:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),o=n.n(c),u=n(13),l=n(3),i=n(12),s=n.n(i),m=n(18),g={USD:"US-Dollar",EUR:"Euro",GBP:"Pound"},f={USD:"$",EUR:"\u20ac",GBP:"\u20a4"},E="Transaction possible!",b="Specify amount to exchange ...",v="Not enough amount in your current Pocket ...",y="Exchange Rates not loaded yet ...",d=Object(l.atomFamily)({key:"pocketState",default:0}),p=Object(l.selector)({key:"pocketListState",get:function(e){var t=e.get;return Object.entries(g).map((function(e){var n=Object(u.a)(e,2),a=n[0];return{currency:a,name:n[1],amount:t(d(a))}}))}}),h=Object(l.selector)({key:"pocketOriginState",get:function(e){var t=e.get;return t(d(t(G)))},set:function(e,t){var n=e.set,a=e.get;return n(d(a(G)),t)}}),j=Object(l.selector)({key:"pocketDestinationState",get:function(e){var t=e.get;return t(d(t(I)))},set:function(e,t){var n=e.set,a=e.get;return n(d(a(I)),t)}}),O=function(e){var t=e.set,n=e.snapshot;return Object(m.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPromise(I);case 2:a=e.sent,t(G,a);case 4:case"end":return e.stop()}}),e)})))},x={USD:100,EUR:50,GBP:0},k=function(e){var t=localStorage.getItem(e);return t?parseFloat(t):x[e]},S=function(e,t){return localStorage.setItem(e,t.toString())},R=Object(l.selector)({key:"transactionOriginState",get:function(e){var t=e.get;return{amount:t(V),currency:t(G)}}}),C=Object(l.selector)({key:"transactionDestinationState",get:function(e){var t=e.get;return{amount:t(z),currency:t(I)}}}),w=Object(l.selector)({key:"calculatePocketOriginState",get:function(e){var t=e.get;return{currency:t(G),amount:t(h)+t(V)}}}),U=Object(l.selector)({key:"calculatePocketDestinationState",get:function(e){var t=e.get;return{currency:t(I),amount:t(j)+t(z)}}}),P=Object(l.atom)({key:"amountState",default:[0,0]}),D=function(e){var t=e?0:1,n=e?"amountOriginState":"amountDestinationState";return Object(l.selector)({key:n,get:function(e){return(0,e.get)(P)[t]},set:function(t,n){var a=t.set,r=t.get;if(n instanceof l.DefaultValue)return a(P,n);var c=r(K);a(P,e?[n,n*c]:[n/c,n])}})},V=D(!0),z=D(!1),B=function(e){var t=e.set,n=e.snapshot,a=e.reset;return Object(m.a)(s.a.mark((function e(){var r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPromise(w);case 2:return r=e.sent,e.next=5,n.getPromise(U);case 5:c=e.sent,t(h,r.amount),t(j,c.amount),a(V),a(z),S(r.currency,r.amount),S(c.currency,c.amount);case 12:case"end":return e.stop()}}),e)})))},F=Object(l.atom)({key:"currencyState",default:["USD","EUR"]}),A=function(e){var t=e?0:1,n=e?"currencyOriginState":"currencyDestinationState";return Object(l.selector)({key:n,get:function(e){return(0,e.get)(F)[t]},set:function(e,n){var a=e.set,r=e.get;if(n instanceof l.DefaultValue)return a(F,n);var c=Array.from(r(F));if(c.includes(n))return a(F,Array.from(r(F)).reverse()),a(P,Array.from(r(P)).reverse());c[t]=n,a(F,c)}})},G=A(!0),I=A(!1),T=Object(l.atomFamily)({key:"exchangeRateState",default:{exchange:{USD:0,EUR:0,GBP:0},lastUpdate:null}}),$=Object(l.selector)({key:"exchangeEnabledState",get:function(e){return(0,e.get)(J)===E}}),J=Object(l.selector)({key:"exchangeInformationState",get:function(e){var t=e.get,n=t(V),a=t(h),r=t(M);return 0===n?b:a<n?v:r?E:y}}),K=Object(l.selector)({key:"currentExchangeRateState",get:function(e){var t=e.get,n=t(G),a=t(I);return t(T(n)).exchange[a]}}),M=Object(l.selector)({key:"lastUpdateCurrentExchangeRateState",get:function(e){var t=e.get,n=t(G);return t(T(n)).lastUpdate}}),L=function(e){var t=e.set,n=e.snapshot;return Object(m.a)(s.a.mark((function e(){var a,r,c,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPromise(G);case 2:return a=e.sent,e.prev=3,e.next=6,fetch("https://api.exchangeratesapi.io/latest?base=".concat(a));case 6:return r=e.sent,e.next=9,r.json();case 9:c=e.sent,o=c.rates,u=c.date,t(T(a),{exchange:o,lastUpdate:u}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("There was an error while trying to get exchange Rates ...");case 18:case"end":return e.stop()}}),e,null,[[3,15]])})))},N=n(133),W=function(){var e=!Object(l.useRecoilValue)($);return r.a.createElement(N.a,{size:"large",primary:!0,type:"submit",a11yTitle:"Exchange amount",disabled:e,label:"Exchange"})},q=n(119),H=function(){return"small"===Object(a.useContext)(q.a)},Q=n(129),X=n(136),Y=function(e){var t=e.currency,n=e.amount;return"".concat(f[t]," ").concat(n.toFixed(2))},Z=function(){var e=Object(l.useRecoilValue)(K),t=Object(l.useRecoilValue)(M),n=Object(l.useRecoilValue)(G),c={amount:e,currency:Object(l.useRecoilValue)(I)},o=Object(l.useRecoilCallback)(L);return t||o(),function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}),[t])}((function(){o()}),1e4),r.a.createElement(Q.a,{label:"Exchange Rate"},r.a.createElement(X.a,{margin:"small",weight:"bold"},f[n]," 1 = ",function(e){var t=e.currency,n=e.amount;return"".concat(f[t]," ").concat(n.toFixed(10))}(c)))},_=n(126),ee=n(127),te=n(139),ne=n(128),ae=n(28),re=n(135),ce=n(124),oe=function(){return!1},ue=n(123),le=function(e){var t=e.origin,n=e.destination;return r.a.createElement(X.a,{size:"xxlarge"},r.a.createElement(ae.a,{align:"center",direction:"row",margin:"medium",justify:"center"},Y(t),r.a.createElement(ue.a,{size:"large"}),Y(n)))},ie=function(e){var t=e.origin,n=e.destination;return r.a.createElement(ae.a,{justify:"around",direction:"row",margin:"medium"},r.a.createElement(ae.a,{align:"center"},r.a.createElement(X.a,{size:"large",weight:"bold"},t.currency," Pocket"),r.a.createElement(X.a,{size:"large",color:"red"},Y(t))),r.a.createElement(ae.a,{align:"center"},r.a.createElement(X.a,{size:"large",weight:"bold"},n.currency," Pocket"),r.a.createElement(X.a,{size:"large",color:"green"},Y(n))))},se=function(e){var t=e.onClose,n=e.title;return r.a.createElement(ae.a,{direction:"row",align:"center",tag:"header",elevation:"small",justify:"between"},r.a.createElement(X.a,{margin:"small",weight:"bold"},n),r.a.createElement(N.a,{icon:r.a.createElement(ce.a,null),a11yTitle:"Close button",onClick:t}))},me=function(e){var t=e.onClose,n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(t,e.onConfirm);return r.a.createElement(ae.a,{direction:"row",gap:"medium",justify:"center"},r.a.createElement(N.a,{secondary:!0,label:"Cancel",onClick:t}),r.a.createElement(N.a,{primary:!0,label:"Confirm",onClick:n}))},ge=function(e){var t=e.onClose,n=e.onConfirm,a=Object(l.useRecoilValue)(R),c=Object(l.useRecoilValue)(C),o=Object(l.useRecoilValue)(w),u=Object(l.useRecoilValue)(U);return r.a.createElement(re.a,{position:"center",onClickOutside:t,onEsc:t,animation:"slide",modal:!0},r.a.createElement(se,{onClose:t,title:"Confirm Transaction"}),r.a.createElement(ae.a,{margin:"medium"},r.a.createElement(X.a,null,"Are you sure you want to exchange the following amount?"),r.a.createElement(le,{origin:a,destination:c}),r.a.createElement(X.a,null,"Status of accounts after exchange:"),r.a.createElement(ie,{origin:o,destination:u}),r.a.createElement(me,{onClose:t,onConfirm:n})))},fe=n(137),Ee=function(){var e=Object(l.useRecoilValue)(M),t=H();return r.a.createElement(ae.a,{as:"footer",direction:t?"column":"row",align:"center",justify:"between",fill:"horizontal"},r.a.createElement(X.a,null,"Exchange Rate Update: ",e),r.a.createElement(X.a,null,"Made by ",r.a.createElement(fe.a,{href:"https://github.com/EmaSuriano"},"EmaSuriano")))},be=n(125),ve=function(){var e=Object(l.useRecoilCallback)(O);return r.a.createElement(N.a,{onClick:e,primary:!0,icon:r.a.createElement(be.a,null),a11yTitle:"Swap Pockets"})},ye=n(130),de=function(e){var t=e.onChange,n=void 0===t?oe:t,a=e.options,c=e.currency;return r.a.createElement(ye.a,{value:c,options:a,labelKey:"label",valueKey:{key:"value",reduce:!0},onChange:function(e){var t=e.value;return n(t)}})},pe=n(138),he=function(e){var t=e.onChange,n=void 0===t?oe:t,c=e.amount,o=e.currency,l=e.label,i=Object(a.useState)(!1),s=Object(u.a)(i,2),m=s[0],g=s[1],E="".concat(c).concat(m?".":"");return r.a.createElement(Q.a,{label:l},r.a.createElement(pe.a,{size:"xxlarge",value:E,icon:r.a.createElement(X.a,null,f[o]),mask:[{regexp:/^[0-9]*$/,placeholder:"0"},{fixed:"."},{length:2,regexp:/^[0-9]*$/,placeholder:"00"}],onChange:function(e){var t=e.target.value;g(t.endsWith("."));var a=parseFloat(t)||0;if(a!==c&&a<9999999999)return n(a)}}))},je=function(e){var t=e.origin,n=Object(l.useRecoilState)(t?G:I),a=Object(u.a)(n,2),c=a[0],o=a[1],i=Object(l.useRecoilState)(t?V:z),s=Object(u.a)(i,2),m=s[0],g=s[1],f=Object(l.useRecoilValue)(p).map((function(e){var t=e.name,n=e.amount,a=e.currency;return{label:"".concat(t," - ").concat(n.toFixed(2)),value:a}})),E=t?"Exchange":"Receive";return r.a.createElement(ae.a,null,r.a.createElement(de,{currency:c,onChange:o,options:f}),r.a.createElement(he,{label:E,amount:m,onChange:g,currency:c}))},Oe=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(l.useRecoilCallback)(B),i=H();return r.a.createElement(_.a,{fill:!0,align:"center",justify:"center",pad:{horizontal:"medium"}},r.a.createElement(ee.a,null,r.a.createElement(te.a,null,"Exchange App")),r.a.createElement(ne.a,{onSubmit:function(){return c(!0)}},r.a.createElement(ae.a,{direction:i?"column":"row",align:"center",justify:"center",pad:"medium",gap:"medium"},r.a.createElement(je,{origin:!0}),r.a.createElement(ve,null),r.a.createElement(je,{origin:!1})),r.a.createElement(ae.a,{align:"center",justify:"center",pad:"medium",direction:"row"},r.a.createElement(W,null),r.a.createElement(Z,null))),n&&r.a.createElement(ge,{onClose:function(){return c(!1)},onConfirm:o}),r.a.createElement(Ee,null))},xe=n(132),ke=n(63);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.RecoilRoot,{initializeState:function(e){var t=e.set;t(d("EUR"),k("EUR")),t(d("USD"),k("USD")),t(d("GBP"),k("GBP"))}},r.a.createElement(xe.a,{theme:ke.grommet},r.a.createElement(Oe,null)))),document.getElementById("root"))},69:function(e,t,n){e.exports=n(110)}},[[69,1,2]]]);
//# sourceMappingURL=main.3b0bed23.chunk.js.map