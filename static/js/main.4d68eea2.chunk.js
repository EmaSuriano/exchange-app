(this["webpackJsonpexchange-app"]=this["webpackJsonpexchange-app"]||[]).push([[0],{110:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),o=a.n(c),u=a(12),l=a(3),i=a(13),s=a.n(i),m=a(18),g={USD:"US-Dollar",EUR:"Euro",GBP:"Pound"},f={USD:"$",EUR:"\u20ac",GBP:"\u20a4"},b="Transaction possible!",E="Specify amount to exchange ...",p="Not enough amount in your current Pocket ...",d="Exchange Rates not loaded yet ...",v=Object(l.atomFamily)({key:"pocketState",default:0}),y=Object(l.selector)({key:"pocketListState",get:function(e){var t=e.get;return Object.entries(g).map((function(e){var a=Object(u.a)(e,2),n=a[0];return{currency:n,name:a[1],amount:t(v(n))}}))}}),h=Object(l.selector)({key:"pocketOriginState",get:function(e){var t=e.get;return t(v(t(B)))},set:function(e,t){var a=e.set,n=e.get;return a(v(n(B)),t)}}),j=Object(l.selector)({key:"pocketDestinationState",get:function(e){var t=e.get;return t(v(t(G)))},set:function(e,t){var a=e.set,n=e.get;return a(v(n(G)),t)}}),O=function(e){var t=e.set,a=e.snapshot;return Object(m.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPromise(G);case 2:n=e.sent,t(B,n);case 4:case"end":return e.stop()}}),e)})))},x={USD:100,EUR:50,GBP:0},k=function(e){var t=localStorage.getItem(e);return t?parseFloat(t):x[e]},S=function(e,t){return localStorage.setItem(e,t.toString())},R=Object(l.selector)({key:"transactionOriginState",get:function(e){var t=e.get;return{amount:t(V),currency:t(B)}}}),C=Object(l.selector)({key:"transactionDestinationState",get:function(e){var t=e.get;return{amount:t(A),currency:t(G)}}}),w=Object(l.selector)({key:"calculatePocketOriginState",get:function(e){var t=e.get;return{currency:t(B),amount:t(h)+t(V)}}}),U=Object(l.selector)({key:"calculatePocketDestinationState",get:function(e){var t=e.get;return{currency:t(G),amount:t(j)+t(A)}}}),P=Object(l.atom)({key:"amountState",default:[0,0]}),D=function(e){var t=e?0:1,a=e?"amountOriginState":"amountDestinationState";return Object(l.selector)({key:a,get:function(e){return(0,e.get)(P)[t]},set:function(t,a){var n=t.set,r=t.get;if(a instanceof l.DefaultValue)return n(P,a);var c=r(J);n(P,e?[a,a*c]:[a/c,a])}})},V=D(!0),A=D(!1),z=function(e){var t=e.set,a=e.snapshot,n=e.reset;return Object(m.a)(s.a.mark((function e(){var r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPromise(w);case 2:return r=e.sent,e.next=5,a.getPromise(U);case 5:c=e.sent,t(h,r.amount),t(j,c.amount),n(V),n(A),S(r.currency,r.amount),S(c.currency,c.amount);case 12:case"end":return e.stop()}}),e)})))},F=Object(l.atom)({key:"currencyState",default:["USD","EUR"]}),I=function(e){var t=e?0:1,a=e?"currencyOriginState":"currencyDestinationState";return Object(l.selector)({key:a,get:function(e){return(0,e.get)(F)[t]},set:function(e,a){var n=e.set,r=e.get;if(a instanceof l.DefaultValue)return n(F,a);var c=Array.from(r(F));if(c.includes(a))return n(F,Array.from(r(F)).reverse()),n(P,Array.from(r(P)).reverse());c[t]=a,n(F,c)}})},B=I(!0),G=I(!1),T=Object(l.atomFamily)({key:"exchangeRateState",default:{exchange:{USD:0,EUR:0,GBP:0},lastUpdate:null}}),M=Object(l.selector)({key:"exchangeEnabledState",get:function(e){return(0,e.get)($)===b}}),$=Object(l.selector)({key:"exchangeInformationState",get:function(e){var t=e.get,a=t(V),n=t(h),r=t(K);return 0===a?E:n<a?p:r?b:d}}),J=Object(l.selector)({key:"currentExchangeRateState",get:function(e){var t=e.get,a=t(B),n=t(G);return t(T(a)).exchange[n]}}),K=Object(l.selector)({key:"lastUpdateCurrentExchangeRateState",get:function(e){var t=e.get,a=t(B);return t(T(a)).lastUpdate}}),L=function(e){var t=e.set,a=e.snapshot;return Object(m.a)(s.a.mark((function e(){var n,r,c,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPromise(B);case 2:return n=e.sent,e.prev=3,e.next=6,fetch("https://api.exchangeratesapi.io/latest?base=".concat(n));case 6:return r=e.sent,e.next=9,r.json();case 9:c=e.sent,o=c.rates,u=c.date,t(T(n),{exchange:o,lastUpdate:u}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("There was an error while trying to get exchange Rates ...");case 18:case"end":return e.stop()}}),e,null,[[3,15]])})))},W=a(133),N=a(120),q=a(117),H="small",Q=function(){return Object(n.useContext)(q.a)===H},X=function(){var e=!Object(l.useRecoilValue)(M),t=Q();return r.a.createElement(W.a,{size:"large",gap:"medium",type:"submit",a11yTitle:"Exchange amount",disabled:e,label:"Exchange",icon:r.a.createElement(N.a,null),fill:t&&"horizontal",primary:!0})},Y=function(e){var t=e.currency,a=e.amount;return"".concat(f[t]).concat(a.toFixed(2))},Z=function(){var e=Object(l.useRecoilValue)(J),t=Object(l.useRecoilValue)(K),a=Object(l.useRecoilValue)(B),c=Object(l.useRecoilValue)(G),o=Object(l.useRecoilCallback)(L),u=Object(l.useRecoilCallback)(O);t||o(),function(e,t){var a=Object(n.useRef)();Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}),[t])}((function(){o()}),1e4);var i="".concat(f[a],"1 = ").concat(function(e){var t=e.currency,a=e.amount;return"".concat(f[t]).concat(a.toFixed(4))}({amount:e,currency:c}));return r.a.createElement(W.a,{onClick:u,color:"accent-1",label:i,primary:!0})},_=a(126),ee=a(127),te=a(139),ae=a(128),ne=a(28),re=a(134),ce=a(136),oe=a(123),ue=function(){return!1},le=a(121),ie=function(e){var t=e.origin,a=e.destination;return r.a.createElement(ce.a,{size:"xxlarge"},r.a.createElement(ne.a,{align:"center",direction:"row",margin:"medium",justify:"center"},Y(t),r.a.createElement(le.a,{size:"large"}),Y(a)))},se=function(e){var t=e.pocket,a=e.origin;return r.a.createElement(ne.a,{align:"center",gap:"small"},r.a.createElement(ce.a,{size:"large",weight:"bold"},t.currency," Pocket"),r.a.createElement(ce.a,{size:"large",color:a?"status-critical":"status-ok"},Y(t)))},me=function(e){var t=e.onClose,a=e.title;return r.a.createElement(ne.a,{direction:"row",align:"center",tag:"header",elevation:"small",justify:"between"},r.a.createElement(ce.a,{margin:"small",weight:"bold"},a),r.a.createElement(W.a,{icon:r.a.createElement(oe.a,null),a11yTitle:"Close button",onClick:t}))},ge=function(e){var t=e.onClose,a=e.onConfirm,n=Object(l.useRecoilValue)(R),c=Object(l.useRecoilValue)(C),o=Object(l.useRecoilValue)(w),u=Object(l.useRecoilValue)(U),i=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(t,a);return r.a.createElement(re.a,{position:"center",onClickOutside:t,onEsc:t,animation:"slide",responsive:!1,modal:!0},r.a.createElement(me,{onClose:t,title:"Confirm Transaction"}),r.a.createElement(ne.a,{gap:"medium",margin:"medium",width:"500px"},r.a.createElement(ne.a,null,r.a.createElement(ce.a,null,"Are you sure you want to exchange the following amount?"),r.a.createElement(ie,{origin:n,destination:c})),r.a.createElement(ne.a,null,r.a.createElement(ce.a,null,"Status of accounts after exchange:"),r.a.createElement(ne.a,{justify:"around",direction:"row",margin:"medium"},r.a.createElement(se,{pocket:o,origin:!0}),r.a.createElement(se,{pocket:u,origin:!1}))),r.a.createElement(ne.a,{direction:"row",gap:"medium",justify:"center"},r.a.createElement(W.a,{secondary:!0,label:"Cancel",onClick:t}),r.a.createElement(W.a,{primary:!0,label:"Confirm",onClick:i}))))},fe=a(137),be=a(131),Ee=function(e){var t=e.target,a=e.children,n=e.position,c="bottom"===n?"bottom":void 0,o="right"===n?"right":void 0;return r.a.createElement(be.a,{align:{top:c,left:o},target:t,plain:!0},r.a.createElement(ne.a,{margin:"small",pad:"small",background:"accent-1",round:"small"},a))},pe=function(){var e=Object(l.useRecoilValue)(K),t=Q(),a=Object(n.useState)(!1),c=Object(u.a)(a,2),o=c[0],i=c[1],s=Object(n.useRef)(null);return r.a.createElement(n.Fragment,null,r.a.createElement(ne.a,{as:"footer",fill:"horizontal",gap:"medium",justify:"between",direction:t?"column":"row"},r.a.createElement(ne.a,{ref:s,onMouseOver:function(){return i(!0)},onMouseOut:function(){return i(!1)}},r.a.createElement(ce.a,{textAlign:"center"},"Rates provided by"," ",r.a.createElement(fe.a,{href:"https://exchangeratesapi.io/"},"Exchange Rates API"))),r.a.createElement(ce.a,{textAlign:"center"},"Made by"," ",r.a.createElement(fe.a,{href:"https://github.com/EmaSuriano"},"EmaSuriano"))),s.current&&o&&r.a.createElement(Ee,{target:s.current,position:t?"bottom":"right"},r.a.createElement(ce.a,{textAlign:"center"},"Last update: ",r.a.createElement("b",null,e))))},de=a(130),ve=function(e){var t=e.onChange,a=void 0===t?ue:t,n=e.options,c=e.currency;return r.a.createElement(de.a,{a11yTitle:"Pocket Select",value:c,options:n,labelKey:"label",valueKey:{key:"value",reduce:!0},onChange:function(e){var t=e.value;return a(t)}})},ye=a(129),he=a(138),je=[{regexp:/^[0-9]*$/,placeholder:"0"},{fixed:"."},{length:2,regexp:/^[0-9]*$/,placeholder:"00"}],Oe=function(e){var t=e.onChange,a=void 0===t?ue:t,c=e.amount,o=e.currency,l=e.label,i=Object(n.useState)(!1),s=Object(u.a)(i,2),m=s[0],g=s[1],b=m?"".concat(c).concat("."):function(e){if(Math.floor(e)===e)return e;var t=e.toString().split(".")[1].length,a=t<2?t:2;return e.toFixed(a)}(c);return r.a.createElement(ye.a,{label:l},r.a.createElement(he.a,{"aria-label":"Amount Input",size:"xxlarge",value:b,icon:r.a.createElement(ce.a,{size:"xxlarge"},f[o]),mask:je,onChange:function(e){var t=e.target.value;g(t.endsWith("."));var n=parseFloat(t)||0;n===c||n>9999999999||a(n)}}))},xe=function(e){var t=e.origin,a=Object(l.useRecoilState)(t?B:G),n=Object(u.a)(a,2),c=n[0],o=n[1],i=Object(l.useRecoilState)(t?V:A),s=Object(u.a)(i,2),m=s[0],g=s[1],f=Object(l.useRecoilValue)(y).map((function(e){var t=e.name,a=e.amount,n=e.currency;return{label:"".concat(t," - ").concat(a.toFixed(2)),value:n}})),b=t?"Exchange":"Receive";return r.a.createElement(ne.a,{gap:"small"},r.a.createElement(ve,{currency:c,onChange:o,options:f}),r.a.createElement(Oe,{label:b,amount:m,onChange:g,currency:c}))},ke=function(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(l.useRecoilCallback)(z),i=Q();return r.a.createElement(_.a,{fill:!0,align:"center",justify:"center",pad:"medium",background:"background-front"},r.a.createElement(ee.a,{margin:"small"},r.a.createElement(te.a,null,"\ud83d\udcb8 Exchange App \ud83d\udcb8")),r.a.createElement(ae.a,{onSubmit:function(){return c(!0)}},r.a.createElement(ne.a,{align:"center",justify:"center",gap:"medium",margin:"medium"},r.a.createElement(ne.a,{direction:i?"column":"row",align:"center",justify:"center",gap:"large"},r.a.createElement(xe,{origin:!0}),r.a.createElement(ne.a,{gap:"medium",style:{minWidth:i?"100%":"200px"}},r.a.createElement(Z,null),!i&&r.a.createElement(X,null)),r.a.createElement(xe,{origin:!1})),i&&r.a.createElement(X,null),r.a.createElement(pe,null))),a&&r.a.createElement(ge,{onClose:function(){return c(!1)},onConfirm:o}))},Se=a(132),Re=a(63);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.RecoilRoot,{initializeState:function(e){var t=e.set;t(v("EUR"),k("EUR")),t(v("USD"),k("USD")),t(v("GBP"),k("GBP"))}},r.a.createElement(Se.a,{theme:Re.grommet,full:!0},r.a.createElement(ke,null)))),document.getElementById("root"))},69:function(e,t,a){e.exports=a(110)}},[[69,1,2]]]);
//# sourceMappingURL=main.4d68eea2.chunk.js.map