(this["webpackJsonpexchange-app"]=this["webpackJsonpexchange-app"]||[]).push([[0],{112:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),o=a(11),l=a.n(o),u=a(12),i=a(3),s=a(13),m=a.n(s),g=a(18),f={USD:"US-Dollar",EUR:"Euro",GBP:"Pound"},E={USD:"$",EUR:"\u20ac",GBP:"\u20a4"},b="Transaction possible!",p="Specify amount to exchange ...",d="Not enough amount in your current Pocket ...",h="Exchange Rates not loaded yet ...",v=Object(i.atomFamily)({key:"pocketState",default:0}),y=Object(i.selector)({key:"pocketListState",get:function(e){var t=e.get;return Object.entries(f).map((function(e){var a=Object(u.a)(e,2),n=a[0];return{currency:n,name:a[1],amount:t(v(n))}}))}}),j=Object(i.selector)({key:"pocketOriginState",get:function(e){var t=e.get;return t(v(t(G)))},set:function(e,t){var a=e.set,n=e.get;return a(v(n(G)),t)}}),O=Object(i.selector)({key:"pocketDestinationState",get:function(e){var t=e.get;return t(v(t(I)))},set:function(e,t){var a=e.set,n=e.get;return a(v(n(I)),t)}}),x=function(e){var t=e.set,a=e.snapshot;return Object(g.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPromise(I);case 2:n=e.sent,t(G,n);case 4:case"end":return e.stop()}}),e)})))},k={USD:100,EUR:50,GBP:0},S=function(e){var t=localStorage.getItem(e);return t?parseFloat(t):k[e]},R=function(e,t){return localStorage.setItem(e,t.toString())},C=Object(i.selector)({key:"transactionOriginState",get:function(e){var t=e.get;return{amount:t(A),currency:t(G)}}}),w=Object(i.selector)({key:"transactionDestinationState",get:function(e){var t=e.get;return{amount:t(z),currency:t(I)}}}),U=Object(i.selector)({key:"calculatePocketOriginState",get:function(e){var t=e.get;return{currency:t(G),amount:t(j)-t(A)}}}),D=Object(i.selector)({key:"calculatePocketDestinationState",get:function(e){var t=e.get;return{currency:t(I),amount:t(O)+t(z)}}}),P=Object(i.atom)({key:"amountState",default:[0,0]}),V=function(e){var t=e?0:1,a=e?"amountOriginState":"amountDestinationState";return Object(i.selector)({key:a,get:function(e){return(0,e.get)(P)[t]},set:function(t,a){var n=t.set,r=t.get;if(a instanceof i.DefaultValue)return n(P,a);var c=r(K);n(P,e?[a,a*c]:[a/c,a])}})},A=V(!0),z=V(!1),B=function(e){var t=e.set,a=e.snapshot,n=e.reset;return Object(g.a)(m.a.mark((function e(){var r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPromise(U);case 2:return r=e.sent,e.next=5,a.getPromise(D);case 5:c=e.sent,t(j,r.amount),t(O,c.amount),n(A),n(z),R(r.currency,r.amount),R(c.currency,c.amount);case 12:case"end":return e.stop()}}),e)})))},F=Object(i.atom)({key:"currencyState",default:["USD","EUR"]}),T=function(e){var t=e?0:1,a=e?"currencyOriginState":"currencyDestinationState";return Object(i.selector)({key:a,get:function(e){return(0,e.get)(F)[t]},set:function(e,a){var n=e.set,r=e.get;if(a instanceof i.DefaultValue)return n(F,a);var c=Array.from(r(F));if(c.includes(a))return n(F,Array.from(r(F)).reverse()),n(P,Array.from(r(P)).reverse());c[t]=a,n(F,c)}})},G=T(!0),I=T(!1),M=Object(i.atomFamily)({key:"exchangeRateState",default:{exchange:{USD:0,EUR:0,GBP:0},lastUpdate:null}}),$=Object(i.selector)({key:"exchangeEnabledState",get:function(e){return(0,e.get)(J)===b}}),J=Object(i.selector)({key:"exchangeInformationState",get:function(e){var t=e.get,a=t(A),n=t(j),r=t(L);return 0===a?p:n<a?d:r?b:h}}),K=Object(i.selector)({key:"currentExchangeRateState",get:function(e){var t=e.get,a=t(G),n=t(I);return t(M(a)).exchange[n]}}),L=Object(i.selector)({key:"lastUpdateCurrentExchangeRateState",get:function(e){var t=e.get,a=t(G);return t(M(a)).lastUpdate}}),W=function(e){var t=e.set,a=e.snapshot;return Object(g.a)(m.a.mark((function e(){var n,r,c,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPromise(G);case 2:return n=e.sent,e.prev=3,e.next=6,fetch("https://api.exchangeratesapi.io/latest?base=".concat(n));case 6:return r=e.sent,e.next=9,r.json();case 9:c=e.sent,o=c.rates,l=c.date,t(M(n),{exchange:o,lastUpdate:l}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("There was an error while trying to get exchange Rates ...");case 18:case"end":return e.stop()}}),e,null,[[3,15]])})))},N=a(135),q=a(122),H=a(119),Q="small",X=function(){return Object(r.useContext)(H.a)===Q},Y=function(){var e=!Object(i.useRecoilValue)($),t=X();return c.a.createElement(N.a,{size:"large",gap:"medium",type:"submit",a11yTitle:"Exchange Amount",disabled:e,label:"Exchange",icon:c.a.createElement(q.a,null),fill:t&&"horizontal",primary:!0})},Z=function(e){var t=e.currency,a=e.amount;return"".concat(E[t]).concat(a.toFixed(2))},_=function(){var e=Object(i.useRecoilValue)(K),t=Object(i.useRecoilValue)(L),a=Object(i.useRecoilValue)(G),n=Object(i.useRecoilValue)(I),o=Object(i.useRecoilCallback)(W),l=Object(i.useRecoilCallback)(x);t||o(),function(e,t){var a=Object(r.useRef)();Object(r.useEffect)((function(){a.current=e}),[e]),Object(r.useEffect)((function(){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}),[t])}((function(){o()}),1e4);var u="".concat(E[a],"1 = ").concat(function(e){var t=e.currency,a=e.amount;return"".concat(E[t]).concat(a.toFixed(4))}({amount:e,currency:n}));return c.a.createElement(N.a,{a11yTitle:"Exchange Rate",onClick:l,color:"accent-1",label:u,primary:!0})},ee=a(128),te=a(129),ae=a(141),ne=a(130),re=a(28),ce=a(136),oe=a(138),le=a(125),ue=function(){return!1},ie=a(123),se=function(e){var t=e.origin,a=e.destination;return c.a.createElement(oe.a,{size:"xxlarge"},c.a.createElement(re.a,{align:"center",direction:"row",margin:"medium",justify:"center"},Z(t),c.a.createElement(ie.a,{size:"large"}),Z(a)))},me=function(e){var t=e.pocket,a=e.origin;return c.a.createElement(re.a,{align:"center",gap:"small"},c.a.createElement(oe.a,{size:"large",weight:"bold"},t.currency," Pocket"),c.a.createElement(oe.a,{size:"large",color:a?"status-critical":"status-ok"},Z(t)))},ge=function(e){var t=e.onClose,a=e.title;return c.a.createElement(re.a,{direction:"row",align:"center",tag:"header",elevation:"small",justify:"between"},c.a.createElement(oe.a,{margin:"small",weight:"bold"},a),c.a.createElement(N.a,{icon:c.a.createElement(le.a,null),a11yTitle:"Close button",onClick:t}))},fe=function(e){var t=e.onClose,a=e.onConfirm,n=Object(i.useRecoilValue)(C),r=Object(i.useRecoilValue)(w),o=Object(i.useRecoilValue)(U),l=Object(i.useRecoilValue)(D),u=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}(t,a);return c.a.createElement(ce.a,{position:"center",onClickOutside:t,onEsc:t,animation:"slide",responsive:!1,margin:"small",modal:!0},c.a.createElement(ge,{onClose:t,title:"Transaction Summary"}),c.a.createElement(re.a,{gap:"medium",pad:"medium",width:"500px"},c.a.createElement(re.a,null,c.a.createElement(oe.a,null,"Are you sure you want to exchange the following amount?"),c.a.createElement(se,{origin:n,destination:r})),c.a.createElement(re.a,null,c.a.createElement(oe.a,null,"Status of accounts after exchange:"),c.a.createElement(re.a,{justify:"around",direction:"row",margin:"medium"},c.a.createElement(me,{pocket:o,origin:!0}),c.a.createElement(me,{pocket:l,origin:!1}))),c.a.createElement(re.a,{direction:"row",gap:"medium",justify:"center"},c.a.createElement(N.a,{secondary:!0,a11yTitle:"Cancel Exchange",label:"Cancel",onClick:t}),c.a.createElement(N.a,{primary:!0,a11yTitle:"Confirm Exchange",label:"Confirm",onClick:u}))))},Ee=a(139),be=a(133),pe=function(e){var t=e.target,a=e.children,n=e.position,r="bottom"===n?"bottom":void 0,o="right"===n?"right":void 0;return c.a.createElement(be.a,{align:{top:r,left:o},target:t,plain:!0},c.a.createElement(re.a,{margin:"small",pad:"small",background:"accent-1",round:"small"},a))},de=function(){var e=Object(i.useRecoilValue)(L),t=X(),a=Object(r.useState)(!1),n=Object(u.a)(a,2),o=n[0],l=n[1],s=Object(r.useRef)(null);return c.a.createElement(r.Fragment,null,c.a.createElement(re.a,{as:"footer",fill:"horizontal",gap:"medium",justify:"between",direction:t?"column":"row"},c.a.createElement(re.a,{ref:s,onMouseOver:function(){return l(!0)},onMouseOut:function(){return l(!1)}},c.a.createElement(oe.a,{textAlign:"center"},"Rates provided by"," ",c.a.createElement(Ee.a,{href:"https://exchangeratesapi.io/"},"Exchange Rates API"))),c.a.createElement(oe.a,{textAlign:"center"},"Made by"," ",c.a.createElement(Ee.a,{href:"https://github.com/EmaSuriano"},"Ema Suriano"))),s.current&&o&&c.a.createElement(pe,{target:s.current,position:t?"bottom":"right"},c.a.createElement(oe.a,{textAlign:"center"},"Last update: ",c.a.createElement("b",null,e))))},he=a(132),ve=function(e){var t=e.onChange,a=void 0===t?ue:t,n=e.options,r=e.currency;return c.a.createElement(he.a,{a11yTitle:"Pocket Select",value:r,options:n,labelKey:"label",valueKey:{key:"value",reduce:!0},onChange:function(e){var t=e.value;return a(t)}})},ye=a(131),je=a(140),Oe=[{regexp:/^[0-9]*$/,placeholder:"0"},{fixed:"."},{length:2,regexp:/^[0-9]*$/,placeholder:"00"}],xe=function(e){var t=e.onChange,a=void 0===t?ue:t,n=e.amount,o=e.currency,l=e.label,i=Object(r.useState)(!1),s=Object(u.a)(i,2),m=s[0],g=s[1],f=!(n%1!==0)&&m?"".concat(n).concat("."):function(e){if(Math.floor(e)===e)return e;var t=e.toString().split(".")[1].length,a=t<2?t:2;return e.toFixed(a)}(n);return c.a.createElement(ye.a,{label:l},c.a.createElement(je.a,{"aria-label":"Amount Input",size:"xxlarge",value:f,icon:c.a.createElement(oe.a,{size:"xxlarge"},E[o]),mask:Oe,onChange:function(e){var t=e.target.value;g(t.endsWith("."));var r=parseFloat(t)||0;r===n||r>9999999999||a(r)}}))},ke=function(e){var t=e.origin,a=Object(i.useRecoilState)(t?G:I),n=Object(u.a)(a,2),r=n[0],o=n[1],l=Object(i.useRecoilState)(t?A:z),s=Object(u.a)(l,2),m=s[0],g=s[1],f=Object(i.useRecoilValue)(y).map((function(e){var t=e.name,a=e.amount,n=e.currency;return{label:"".concat(t," - ").concat(a.toFixed(2)),value:n}})),E=t?"Exchange":"Receive",b=t?"panel-origin":"panel-destination";return c.a.createElement(re.a,{gap:"small","data-testid":b},c.a.createElement(ve,{currency:r,onChange:o,options:f}),c.a.createElement(xe,{label:E,amount:m,onChange:g,currency:r}))},Se=function(){var e=Object(r.useState)(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],o=Object(i.useRecoilCallback)(B),l=X();return c.a.createElement(ee.a,{fill:!0,align:"center",justify:"center",pad:"medium",background:"background-front"},c.a.createElement(te.a,{margin:"small"},c.a.createElement(ae.a,null,"\ud83d\udcb8 Exchange App \ud83d\udcb8")),c.a.createElement(ne.a,{onSubmit:function(){return n(!0)}},c.a.createElement(re.a,{align:"center",justify:"center",gap:"medium",margin:"medium"},c.a.createElement(re.a,{direction:l?"column":"row",align:"center",justify:"center",gap:"large"},c.a.createElement(ke,{origin:!0}),c.a.createElement(re.a,{gap:"medium",style:{minWidth:l?"100%":"200px"}},c.a.createElement(_,null),!l&&c.a.createElement(Y,null)),c.a.createElement(ke,{origin:!1})),l&&c.a.createElement(Y,null),c.a.createElement(de,null))),a&&c.a.createElement(fe,{onClose:function(){return n(!1)},onConfirm:o}))},Re=a(134),Ce=a(64),we=a(63),Ue=a.n(we),De={EUR:S("EUR"),USD:S("USD"),GBP:S("GBP")};l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(i.RecoilRoot,{initializeState:(n=De,function(e){var t=e.set;t(v("EUR"),n.EUR),t(v("USD"),n.USD),t(v("GBP"),n.GBP)})},c.a.createElement(Re.a,{theme:Ce.grommet,full:!0},c.a.createElement(Se,null),c.a.createElement(Ue.a,{href:"https://github.com/EmaSuriano/exchange-app",bannerColor:"#7D4CDB"})))),document.getElementById("root"))},70:function(e,t,a){e.exports=a(112)}},[[70,1,2]]]);
//# sourceMappingURL=main.8022b462.chunk.js.map